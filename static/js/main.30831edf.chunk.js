(this["webpackJsonpws-client"]=this["webpackJsonpws-client"]||[]).push([[0],{12:function(e,t,n){e.exports=n(17)},17:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(3),s=n(4),i=n(1),c=n(5),o=n(0),l=n.n(o),u=n(8),h=n.n(u),d={DATA:0,SOCKET_STATUS:1},f=function(){function e(){Object(a.a)(this,e),this.websocket=null,this.data_callbacks=new Set,this.status_callbacks=new Set,this.EventType=d,this.buffer=[],this.sendBuffer()}return Object(r.a)(e,[{key:"sendBuffer",value:function(){var e=this,t=this.buffer.shift();if(void 0!==t){var n=t.data,a=new Uint8Array(n);this.websocket.send(a),setTimeout((function(){return e.sendBuffer()}),t.wait)}else setTimeout((function(){return e.sendBuffer()}),10)}},{key:"notifyOnStatus",value:function(e){console.log("Websocket status: "+e);var t=!0,n=!1,a=void 0;try{for(var r,s=this.status_callbacks[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){(0,r.value)(e)}}catch(i){n=!0,a=i}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}}},{key:"notifyOnData",value:function(e){var t=e.data,n=new Uint8Array(t);console.log("Recieved: "+n);var a=!0,r=!1,s=void 0;try{for(var i,c=this.data_callbacks[Symbol.iterator]();!(a=(i=c.next()).done);a=!0){if((0,i.value)(n))break}}catch(o){r=!0,s=o}finally{try{a||null==c.return||c.return()}finally{if(r)throw s}}}},{key:"open",value:function(e){var t=this;this.close(),console.log("Opening websocket @ "+e),this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.websocket.onopen=function(e){return t.notifyOnStatus(!0)},this.websocket.onclose=function(e){return t.notifyOnStatus(!1)},this.websocket.onmessage=function(e){return t.notifyOnData(e)}}},{key:"close",value:function(){this.isActive()&&this.websocket.close(),this.websocket=null}},{key:"isActive",value:function(){return null!==this.websocket&&this.websocket.readyState===WebSocket.OPEN}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(this.isActive()){var n={data:e,wait:t};return this.buffer.push(n),!0}return!1}},{key:"getCallbackList",value:function(t){switch(t){case e.EventType.DATA:return this.data_callbacks;case e.EventType.SOCKET_STATUS:return this.status_callbacks;default:return}}},{key:"listen",value:function(e,t){var n=this.getCallbackList(t);return void 0!==n&&n.add(e),this}},{key:"unlisten",value:function(e,t){var n=this.getCallbackList(t);return void 0!==n&&n.delete(e)}}],[{key:"EventType",get:function(){return d}}]),e}(),m=n(6),b=n(9),v=n(7),p=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).callbacks=[[n.dataListener.bind(Object(v.a)(n)),f.EventType.DATA],[n.statusListener.bind(Object(v.a)(n)),f.EventType.SOCKET_STATUS]],n.callbacks.map((function(e){n.props.websocket.listen(e[0],e[1])})),n.state={leds:[]},n.props.websocket.isActive()&&n.getInfo(),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentWillUnmount",value:function(){var e=this;this.callbacks.map((function(t){e.props.websocket.unlisten(t[0],t[1])}))}},{key:"dataListener",value:function(e){if(!(e.length<2||1!==e[0])){console.log("Getting data");var t=e[1];return 2===t&&e.length>=3&&this.onInfo(e),!0}}},{key:"statusListener",value:function(e){e&&this.getInfo()}},{key:"onInfo",value:function(e){var t=e[2];if(t===e.length-3){for(var n=[],a=0;a<t;a++)n.push(e[a+3]);this.setState(Object(m.a)({},this.state,{leds:n}))}else console.warn("Incorrect match between data length and total leds")}},{key:"getInfo",value:function(){this.props.websocket.send([1,2])}},{key:"leds",set:function(e){for(var t=[],n=0;n<e.length;n++){var a=255&e[n];a!==(255&this.state.leds[n])&&(t.push(n),t.push(a))}if(0!==t.length){var r=[1,1].concat(t);this.props.websocket.send(r),this.setState(Object(m.a)({},this.state,{leds:e}))}},get:function(){return this.state.leds}}]),t}(l.a.Component),k=function(e){function t(e){return Object(a.a)(this,t),Object(s.a)(this,Object(i.a)(t).call(this,e))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"onLedChange",value:function(e,t){var n=t.target.value,a=Object(b.a)(this.leds);a[e]=n,this.leds=a}},{key:"createSlider",value:function(e,t){var n=this;return l.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},l.a.createElement("input",{className:"custom-range mr-2 w-90",type:"range",min:"0",max:"128",step:"1",value:e,onChange:function(e){return n.onLedChange(t,e)}}),l.a.createElement("span",{className:"badge badge-primary badge-pill"},e))}},{key:"render",value:function(){for(var e=[],t=0;this.leds&&t<this.leds.length;t+=2){for(var n=[],a=0;a<2;a++){var r=t+a;if(r<this.leds.length){var s=this.leds[r];n.push(l.a.createElement("div",{className:"col",key:r},this.createSlider(s,r)))}}e.push(l.a.createElement("div",{className:"row",key:e.length},n))}return l.a.createElement("div",{className:"container-fluid"},e)}}]),t}(p),y=n(10),w=0,g=1,O={Slider:k,Fader:function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).state={fadeValues:[],fadeDirection:[]},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){return e.updateLeds()}),33)}},{key:"updateLeds",value:function(){if(void 0!==this.leds){for(var e=Object(b.a)(this.leds),t=0;t<e.length;t++){var n=this.state.fadeDirection[t],a=this.state.fadeValues[t];switch(n){case g:e[t]+=a,e[t]>=128&&(e[t]=128,this.state.fadeDirection[t]=w);break;case w:e[t]-=a,e[t]<=0&&(e[t]=0,this.state.fadeDirection[t]=g)}}this.leds=e}}},{key:"onInfo",value:function(e){if(Object(y.a)(Object(i.a)(t.prototype),"onInfo",this).call(this,e),this.leds.length!==this.state.fadeValues.length){var n=this.leds.map((function(){return 0})),a=this.leds.map((function(){return g}));this.setState(Object(m.a)({},this.state,{fadeValues:n,fadeDirection:a}))}}},{key:"componentWillUnmount",value:function(){Object(y.a)(Object(i.a)(t.prototype),"componentWillUnmount",this).call(this),clearInterval(this.interval)}},{key:"onFadeChange",value:function(e,t){var n=Number(t.target.value),a=Object(b.a)(this.state.fadeValues);a[e]=n,this.setState(Object(m.a)({},this.state,{fadeValues:a}))}},{key:"createSlider",value:function(e,t){var n=this;return l.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},l.a.createElement("input",{className:"custom-range mr-2 w-90",type:"range",min:"0",max:"20",step:"1",value:e,onChange:function(e){return n.onFadeChange(t,e)}}),l.a.createElement("span",{className:"badge badge-primary badge-pill"},e))}},{key:"render",value:function(){for(var e=[],t=this.state.fadeValues,n=0;n<t.length;n+=2){for(var a=[],r=0;r<2;r++){var s=n+r;if(s<t.length){var i=t[s];a.push(l.a.createElement("div",{className:"col",key:s},this.createSlider(i,s)))}}e.push(l.a.createElement("div",{className:"row",key:e.length},a))}return l.a.createElement("div",{className:"container-fluid"},e)}}]),t}(p)},E=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).controllers=O,n.state={leds:[],controller:"Slider"},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"setController",value:function(e){this.setState(Object(m.a)({},this.state,{controller:e}))}},{key:"getControllerComponent",value:function(e){var t=O[this.state.controller];return l.a.createElement(t,e)}},{key:"renderControllers",value:function(){var e=this;return Object.keys(this.controllers).map((function(t,n){return l.a.createElement("a",{key:n,className:"dropdown-item",onClick:function(){return e.setController(t)}},t)}))}},{key:"renderHeader",value:function(){return l.a.createElement("div",{className:"d-flex justify-content-between flex-wrap flex-mid-nowrap align-items-center pb-2 mb-3 border-bottom"},l.a.createElement("h3",null,"LED Controls"),l.a.createElement("div",{className:"btn-toolbar mb-2 mb-md-0 dropdown"},l.a.createElement("button",{className:"btn btn-sm btn-outline-secondary dropdown-toggle","data-toggle":"dropdown"},this.state.controller),l.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuLink"},this.renderControllers())))}},{key:"render",value:function(){return l.a.createElement("div",null,this.renderHeader(),this.getControllerComponent({websocket:this.props.websocket}))}}]),t}(l.a.Component),j=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).props.websocket.listen(n.dataListener.bind(Object(v.a)(n)),f.EventType.DATA),n.props.websocket.listen(n.getInfo.bind(Object(v.a)(n)),f.EventType.SOCKET_STATUS),n.state={isPowered:!1},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"turnOn",value:function(){this.props.websocket.send([2,2])}},{key:"turnOff",value:function(){this.props.websocket.send([2,1])}},{key:"reset",value:function(){this.props.websocket.send([2,3])}},{key:"dataListener",value:function(e){if(!(e.length<3||2!==e[0]))return this.onInfo(e),!0}},{key:"onInfo",value:function(e){var t=e[1],n=e[2];switch(t){case 4:this.setState(Object(m.a)({},this.state,{isPowered:n>0}));break;default:console.warn("Unhandled pc io command: "+t)}}},{key:"getInfo",value:function(e){e&&this.props.websocket.send([2,4])}},{key:"renderPowerButton",value:function(){var e=this,t=this.state.isPowered?function(){return e.turnOff()}:function(){return e.turnOn()},n=this.state.isPowered?"btn-danger":"btn-success";return l.a.createElement("button",{type:"button",className:"btn "+n,onClick:t},l.a.createElement("i",{className:"fa fa-power-off"}))}},{key:"renderResetButton",value:function(){var e=this;return l.a.createElement("button",{type:"button",className:"btn btn-warning",onClick:function(){return e.reset()}},l.a.createElement("i",{className:"fa fa-redo"}))}},{key:"render",value:function(){return l.a.createElement("div",{className:"navbar-nav col"},l.a.createElement("div",{className:"btn-group",role:"group"},this.renderPowerButton(),this.renderResetButton()))}}]),t}(l.a.Component),N=["temperature-low","thermometer-quarter","thermometer-half","thermometer-three-quarters","temperature-high"],C=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).props.websocket.listen(n.dataListener.bind(Object(v.a)(n)),f.EventType.DATA),n.props.websocket.listen((function(e){e&&n.getInfo()}),f.EventType.SOCKET_STATUS),n.state={temperature:0,humidity:0},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"dataListener",value:function(e){if(!(e.length<3||3!==e[0]))return this.onInfo(e),!0}},{key:"onInfo",value:function(e){var t=e[1],n=e[2];this.setState(Object(m.a)({},this.state,{humidity:t,temperature:n}))}},{key:"getInfo",value:function(){this.props.websocket.send([3],300)}},{key:"renderBar",value:function(e,t,n,a,r,s){var i={fontSize:a+"em"},c={height:r+"em"};return l.a.createElement("div",{className:"progress",style:c},l.a.createElement("div",{className:"progress-bar "+n,role:"progressbar",style:{width:s+"%"}},l.a.createElement("div",{className:"d-flex d-inline justify-content-center align-items-center"},l.a.createElement("i",{className:"fa fa-"+e,style:i}),l.a.createElement("div",{className:"ml-3 text",style:i},t))))}},{key:"renderTemperature",value:function(){var e=this.state.temperature/50*100,t=(this.state.temperature-10)/10;t=Math.round(t),t=Math.min(t,N.length-1),t=Math.max(t,0);var n=N[t],a=this.state.temperature+"\xb0C";return this.renderBar(n,a,"bg-danger",2.5,3.5,e)}},{key:"renderHumidity",value:function(){var e=this.state.humidity,t=this.state.humidity+"%";return this.renderBar("tint",t,"bg-primary",2.5,3.5,e)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",{className:"d-flex justify-content-between flex-wrap flex-mid-nowrap align-items-center border-bottom pb-2 mt-3 mb-3"},l.a.createElement("h3",null,"DHT11"),l.a.createElement("button",{className:"btn btn-sm btn-outline-secondary",onClick:function(){return e.getInfo()}},"Refresh")),l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col"},this.renderTemperature()),l.a.createElement("div",{className:"col"},this.renderHumidity()))))}}]),t}(l.a.Component),S=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).props.websocket.listen(n.setStatus.bind(Object(v.a)(n)),f.EventType.SOCKET_STATUS),n.state={isConnected:!1,url:"192.168.1.109:80/api/v1/websocket"},setTimeout((function(){return n.open()}),0),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"open",value:function(){this.props.websocket.open("ws://"+this.state.url)}},{key:"close",value:function(){this.props.websocket.close()}},{key:"setStatus",value:function(e){this.setState(Object(m.a)({},this.state,{isConnected:e}))}},{key:"onURLChange",value:function(e){var t=e.target.value;this.setState(Object(m.a)({},this.state,{url:t}))}},{key:"renderURL",value:function(){var e=this;return l.a.createElement("div",{className:"input-group"},l.a.createElement("div",{className:"input-group-prepend"},l.a.createElement("span",{className:"input-group-text"},"ws://")),l.a.createElement("input",{className:"form-control form-control-light",value:this.state.url,onChange:this.onURLChange.bind(this),onKeyDown:function(t){"Enter"===t.key&&e.open()},type:"text","aria-label":"URL"}),this.renderControls())}},{key:"renderControls",value:function(){var e=this,t=this.state.isConnected?"btn-danger":"btn-success",n=this.state.isConnected?function(){return e.close()}:function(){return e.open()},a=this.state.isConnected?"fa fa-unlink":"fa fa-link";return l.a.createElement("div",{className:"input-group-append"},l.a.createElement("button",{type:"button",className:"btn "+t,onClick:n},l.a.createElement("i",{className:a})))}},{key:"render",value:function(){return l.a.createElement("div",{className:"flex-md-nowrap w-100"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-group col"},this.renderURL())))}}]),t}(l.a.Component),T=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).websocket=new f,n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("main",null,l.a.createElement("nav",{className:"navbar navbar-dark sticky-top bg-dark"},l.a.createElement("div",{className:"container flex-md-nowrap"},l.a.createElement(j,{websocket:this.websocket}),l.a.createElement(S,{websocket:this.websocket}))),l.a.createElement("div",{className:"container mt-2"},l.a.createElement(E,{websocket:this.websocket}),l.a.createElement(C,{websocket:this.websocket})))}}]),t}(l.a.Component);h.a.render(l.a.createElement(T,null),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.30831edf.chunk.js.map